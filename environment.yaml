# ===================================================================
# Conda Environment for DTI System Pharmacology Project (GNN-Ready)
#
# To create the environment:
#   $ mamba env create -f environment.yml
#
# To update the environment:
#   $ mamba env update -f environment.yml --prune
# ===================================================================

name: nasnet-gnn # A new, clean name for our GNN-ready environment

channels:
  - pytorch
  - nvidia
  - rdkit
  - bioconda
  - conda-forge
  - defaults

dependencies:
  # --- Core Infrastructure ---
  - python=3.9
  - pip

  # --- PyTorch Stack (Golden Combination) ---
  # We lock the exact versions for maximum stability.
  - pytorch=2.2.1
  - torchvision=0.17.1
  - torchaudio=2.2.1
  - pytorch-cuda=11.8

  # --- Key Scientific Libraries (handled by Conda for robust binary builds) ---
  - numpy=1.26.4 # Explicitly lock numpy to a stable 1.x version
  - pandas
  - scikit-learn
  - rdkit # RDKit is best installed from its own conda channel
  - biopython
  - matplotlib
  - seaborn
  - tqdm
  - joblib

  # --- Project Management & Configuration ---
  - hydra-core
  - hydra-joblib-launcher
  - mlflow

  # --- Pip dependencies ---
  # These will be installed by Conda via pip AFTER all conda packages are installed.
  - pip:
      # --- PyG Stack ---
      # We MUST use pip here to install the pre-compiled wheels from PyG's official source,
      # ensuring perfect compatibility with our PyTorch+CUDA version.
      - pyg-lib --find-links https://data.pyg.org/whl/torch-2.2.0+cu118.html
      - torch-scatter --find-links https://data.pyg.org/whl/torch-2.2.0+cu118.html
      - torch-sparse --find-links https://data.pyg.org/whl/torch-2.2.0+cu118.html
      - torch-cluster --find-links https://data.pyg.org/whl/torch-2.2.0+cu118.html
      - torch-spline-conv --find-links https://data.pyg.org/whl/torch-2.2.0+cu118.html
      - torch-geometric
      - research_template @ git+https://github.com/wozonet1/common_utils.git@dcf7931
